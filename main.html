<html>
<head>
	<title>
	</title>
</head>
<style>
	body{
		width: auto;
	}
	#box1{
		display: flexbox;
	}
	#box2{
		border: 1px solid;
		height: 300px;
		width: 80%;
	}
</style> 
<link rel="stylesheet" href="./fontawesome-free-5.12.1-web/css/all.min.css">
<body>
	<div id="box1">
		<div class="buttonList">
			<button data_tag="I" id="b"><b>b</b></button>
			<button data_tag="I" id="i"><i>i</i></button>
			<button data_tag="I" id="u">_</button>
			<button data_tag="I" id="al"><i class="fas fa-align-left"></i></button>
			<button data_tag="I" id="aj"><i class="fas fa-align-justify"></i></button>
			<button data_tag="I" id="ar"><i class="fas fa-align-right"></i></button>
			<button data_tag="I" id="ac"><i class="fas fa-align-center"></i></button>
		</div>
		<textarea id="txtArea">
		</textarea>
		<div id="box2">
		
		</div>
	</div>
</body>
<script type="text/javascript">
let bNegrito = document.getElementById('b');
let bItalico = document.getElementById('i');
let bUnderscore = document.getElementById('u');
let bAlLeft = document.getElementById('al');
let bAlJustify = document.getElementById('aj');
let bAlRight = document.getElementById('ar');
let bAlCenter = document.getElementById('ac');
let textarea = document.querySelector('textarea');

bNegrito.addEventListener('click',alteraNegrito);
bItalico.addEventListener('click',alteraItalico);
bUnderscore.addEventListener('click',alteraUnderscore);
bAlLeft.addEventListener('click',leftTexto);

textarea.onkeydown = function(){
    box2.innerHTML = textarea.value;
}
function editaAtividade(campo,i){
	if (typeof i == "string")
		campo.attributes[0].value = i;
}
function retornaAtividade(campo){
	
	return campo.attributes[0].value;
}
function leftTexto(){
	
	let box2 = document.querySelector("#box2");

	if (retornaAtividade(bAlLeft) == "I"){
		box2.style.textAlign = "left";
		editaAtividade(bAlLeft,"A");
		editaAtividade(bAlJustify,"I");
		editaAtividade(bAlRight,"I");
		editaAtividade(bAlCenter,"I");
		
	}
}
function rightTexto(){
	
	let box2 = document.querySelector("#box2");

	if (retornaAtividade(bAlRight) == "I"){
		box2.style.textAlign = "left";
		editaAtividade(bAlLeft,"I");
		editaAtividade(bAlJustify,"I");
		editaAtividade(bAlRight,"A");
		editaAtividade(bAlCenter,"I");
		
	}
}
function alteraUnderscore(){
	let box2 = document.querySelector("#box2");

	if (retornaAtividade(bUnderscore) == "I"){
		box2.style.textDecoration = "underline";
		editaAtividade(bUnderscore,"A");
	}
	else{
		box2.style.textDecoration = "none";
		editaAtividade(bUnderscore,"I");
	}
}
function alteraNegrito(){
	let a = textarea.selectionStart 
	let b = textarea.selectionEnd
	console.log(a,b);
	let string = getSelecao(textarea);
	let txt = textarea.value;
	let replacement = "";
	
	textarea.value = replacement;
	replacement = txt.replace(string,string.bold());
	
	textarea.value = replacement;
	
	textarea.selectionStart = a + 3;
	textarea.selectionEnd = b + 3;
	textarea.focus();
	
	document.querySelector("#box2").innerHTML = replacement;
}
function alteraItalico(){
	let string = getSelecao(textarea);
	let txt = textarea.value;
	let replacement = "";
	
	textarea.value = replacement;
	replacement = txt.replace(string,string.italics());
	
	textarea.value = replacement;
	document.querySelector("#box2").innerHTML = replacement;
}
function getSelecao(campo){
	if(document.selection){
		sel = document.selection.createRange().text;
	}else{
		sel = campo.value.substring(campo.selectionStart, campo.selectionEnd);
	}
	return sel;
}
</script>
</html>